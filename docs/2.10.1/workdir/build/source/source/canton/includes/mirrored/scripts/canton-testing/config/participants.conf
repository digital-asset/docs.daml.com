include required("_server-configs.conf")
include required("shared.conf")
# Only valid when mixed with <db>/_persistence.conf

canton {
  participants {
    participant1 {
      parameters {
        dev-version-support = yes
        beta-version-support = yes
      }
      admin-api = ${_participant1.admin-api}
      ledger-api = ${_participant1.ledger-api}

      storage = ${_persistence.participant1Storage}
      storage.parameters.max-connections = ${PARTICIPANTS_MAX_CONNECTIONS}

      init.parameters.unique-contract-keys = true

      replication {
        enabled = ${PARTICIPANT_HA}
        connection-pool = {}
      }
    }
  }

  remote-domain-managers {
    da.admin-api = ${_da.admin-api}
  }

  remote-sequencers {
    sequencer.admin-api = ${_sequencer.admin-api}
    sequencer.public-api = ${_sequencer.public-api}
  }
}

# IMPORTANT: This option is ignored for Oracle. The Ledger API doesn't support asynchronous commit mode for Oracle
# and always uses synchronous commit mode. See also Canton issue #6789 for context
# user-manual-entry-begin: AsynchronousCommitMode
canton.participants.participant1.ledger-api.postgres-data-source.synchronous-commit = off
# user-manual-entry-end: AsynchronousCommitMode

# Duplicating the setting from _persistence.conf so that it can be included into the documentation:
# user-manual-entry-begin: DbTaskQueueSize
canton.participants.participant1.storage.config.queueSize = 10000
# user-manual-entry-end: DbTaskQueueSize
