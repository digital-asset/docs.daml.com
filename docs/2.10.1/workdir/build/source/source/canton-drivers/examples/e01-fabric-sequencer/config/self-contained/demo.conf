_org1-user-path="tmp/crypto-config/peerOrganizations/org1.example.com/users/User1@org1.example.com"
_org2-user-path="tmp/crypto-config/peerOrganizations/org2.example.com/users/User1@org2.example.com"
_ordeder-org-tls-cert-file-path="tmp/crypto-config/ordererOrganizations/example.com/users/Admin@example.com/tls/ca.crt"

canton {
  features {
    enable-testing-commands=yes
  }
  domain-managers {
    myDomain {
      init.domain-parameters.protocol-version = 5
      storage {
        type = memory
      }
      admin-api.port = 5019
    }
  }
  mediators.mediator1 {}

  participants {
    participant1 {
      storage {
        type = memory
      }
      admin-api {
        port= 5012
        address = "0.0.0.0"
      }
      ledger-api {
        port = 5011
        address = "0.0.0.0"
      }
    }

    participant2 {
      storage {
        type = memory
      }
      admin-api {
        port= 5022
        address = "0.0.0.0"
      }
      ledger-api {
        port = 5021
        address = "0.0.0.0"
      }
    }
  }
  sequencers {
    fabricSequencer1 {
      public-api {
        port = 3000
        address = "0.0.0.0"
      }
      admin-api {
        port = 4000
        address = "0.0.0.0"
      }
      sequencer {
        type = "fabric"
        config {
          user = {
            msp-id=Org1MSP
            organization-name="org1.example.com"
            client-user=User1
            private-key-file=${_org1-user-path}"/msp/keystore/priv_sk"
            signed-cert-file=${_org1-user-path}"/msp/signcerts/User1@org1.example.com-cert.pem"
          }
          organizations=[
            {
              name="org1.example.com"
              tls-cert-file=${_org1-user-path}"/tls/ca.crt"
              orderers=[]
              peers=[
                {
                  name=peer0
                  url="grpcs://localhost:7051"
                }
              ]
            },
            {
              name="org2.example.com"
              tls-cert-file=${_org2-user-path}"/tls/ca.crt"
              orderers=[]
              peers=[
                {
                  name=peer0
                  url="grpcs://localhost:9051"
                }
              ]
            },
            {
              name="example.com"
              tls-cert-file=${_ordeder-org-tls-cert-file-path}
              orderers=[
                {
                  name=orderer
                  url="grpcs://localhost:7050"
                }
              ]
              peers=[]
            }
          ]
          channel {
            name=mychannel
            chaincode {
              query-wait-time-millis=30000
              invoke-wait-time-millis=60000
            }
          }
        }
      }
    }
    fabricSequencer2 {
      public-api {
        port = 3001
        address = "0.0.0.0"
      }
      admin-api {
        port = 4001
        address = "0.0.0.0"
      }
      sequencer {
        type = "fabric"
        config {
          user = {
            msp-id=Org2MSP
            organization-name="org2.example.com"
            client-user=User1
            private-key-file=${_org2-user-path}"/msp/keystore/priv_sk"
            signed-cert-file=${_org2-user-path}"/msp/signcerts/User1@org2.example.com-cert.pem"
          }
          organizations=[
            {
              name="org2.example.com"
              tls-cert-file=${_org2-user-path}"/tls/ca.crt"
              orderers=[]
              peers=[
                {
                  name=peer0
                  url="grpcs://localhost:9051"
                }
              ]
            },
            {
              name="org1.example.com"
              tls-cert-file=${_org1-user-path}"/tls/ca.crt"
              orderers=[]
              peers=[
                {
                  name=peer0
                  url="grpcs://localhost:7051"
                }
              ]
            },
            {
              name="example.com"
              tls-cert-file=${_ordeder-org-tls-cert-file-path}
              orderers=[
                {
                  name=orderer
                  url="grpcs://localhost:7050"
                }
              ]
              peers=[]
            }
          ]
          channel {
            name=mychannel
            chaincode {
              query-wait-time-millis=30000
              invoke-wait-time-millis=60000
            }
          }
        }
      }
    }
  }
}
