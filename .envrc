use nix

PATH_add bin

pyenv=.python-env

if ! [ -d $pyenv ]; then
    python3 -m venv $pyenv
fi

source $pyenv/bin/activate
PATH_add $pyenv/bin

python -m pip install -r requirements.txt
git clone https://github.com/bame-da/sphinx-external-toc.git
cd sphinx-external-toc
git checkout 8a33082711c7ccf3472a9381f9c9eee474f71a2d
flit install
cd ..
rm -rf sphinx-external-toc
[[ -f .envrc.private ]] && source_env .envrc.private

watch_file requirements.txt
