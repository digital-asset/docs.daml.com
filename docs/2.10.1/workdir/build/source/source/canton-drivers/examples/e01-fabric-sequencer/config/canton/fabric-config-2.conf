# Copyright (c) 2023 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
# SPDX-License-Identifier: Apache-2.0

_org2-user-path="/etc/ledger-data/crypto-config/peerOrganizations/org2.example.com/users/User1@org2.example.com"
canton.sequencers.fabricSequencer2 {
    public-api {
        port = 3001
        address = "0.0.0.0"
    }
    admin-api {
        port = 4001
        address = "0.0.0.0"
    }
    storage {
        type = postgres
        config {
            dataSourceClass = "org.postgresql.ds.PGSimpleDataSource"
            properties = {
                serverName = "pg.database2"
                portNumber = "5432"
                databaseName = "db"
                user = "user"
                password = "pass"
            }
            numThreads = 20
        }
    }
    sequencer {
        type = "fabric"
        config {
            user = {
                msp-id=Org2MSP
                msp=${_org2-user-path}"/msp"
                organization-name="org2.example.com"
                client-user=User1
                private-key-file=${_org2-user-path}"/tls/client.key"
                signed-cert-file=${_org2-user-path}"/tls/client.crt"
            }
            organizations=[
                {
                    name="org2.example.com"
                    tls-cert-file=${_org2-user-path}"/tls/ca.crt"
                    orderers=[]
                    peers=[
                        {
                            name=peer0
                            url="grpcs://peer0.org2.example.com:9051"
                        }
                    ]
                },
                {
                    name="example.com"
                    tls-cert-file="/etc/ledger-data/crypto-config/ordererOrganizations/example.com/users/Admin@example.com/tls/ca.crt"
                    orderers=[
                        {
                            name=orderer
                            url="grpcs://orderer.example.com:7050"
                        }
                    ]
                    peers=[]
                }
            ]
            channel {
                name=mychannel
                chaincode {
                    query-wait-time-millis=30000
                    invoke-wait-time-millis=60000
                }
            }
        }
    }
}